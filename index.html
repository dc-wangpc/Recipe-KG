
<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>æ–‡æœ¬æŒ–æ˜å¤§ä½œä¸š</title>
    <meta name="description" content="æ–‡æœ¬æŒ–æ˜å¤§ä½œä¸šâ€”â€”å…«å¤§èœç³»çŸ¥è¯†å›¾è°±" />
    <meta name="keywords" content="" />
    <meta name="author" content="" />
    <link rel="shortcut icon" href="">
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?cdef6708f1dc40904a5927911ec338c8";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    <script src="https://libs.baidu.com/jquery/2.1.4/jquery.min.js"></script>
    <link href="https://libs.baidu.com/bootstrap/3.3.4/css/bootstrap.min.css" rel="stylesheet">
</head>

<!-- å®šä¹‰æ ·å¼ -->
<style>
/*bodyçš„æ ·å¼*/
body {
    background-color: #272b30;   /*èƒŒæ™¯é¢œè‰²*/
    padding-bottom: 30px, 40px;
    text-align: center;
    font-family: OpenSans-Light, PingFang SC, Hiragino Sans GB, Microsoft Yahei, Microsoft Jhenghei, sans-serif;
}

/*ä¹‹å‰åœ¨jsä»£ç é‡Œé¢å®šä¹‰äº†classesï¼Œè¿™è¾¹å°±ç»™è¿™äº›å†™æ ·å¼*/
.links line {
    stroke: rgb(240, 240, 240); /*çº¿çš„é¢œè‰²*/
    stroke-opacity: 0.2;        /*çº¿çš„é€æ˜åº¦*/
}
.links line.inactive {
    /*display: none !important;*/
    stroke-opacity: 0;
}

.linetexts {
    fill-opacity: 0;
    font-size: 8px ;
    font-family: SimSun;
    fill:#fff;
}
.linetexts.inactive {
    display: none !important;
}

.nodes circle {
    stroke: #fff;
    stroke-width: 1.5px;        /*åœ†çš„æè¾¹å®½åº¦*/
}
.nodes circle:hover {
    cursor: pointer;
}
.nodes circle.inactive {
    display: none !important;
}

/*é»˜è®¤æ˜¾ç¤ºæ‰€æœ‰çš„åœ†åœˆï¼Œè¿›å…¥æ¨¡å¼åˆ‡æ¢ä¹‹åæ‰ä¼šæ˜¾ç¤ºtext*/
.texts text {
    display: none;
}
.texts text:hover {
    cursor: pointer;
}
.texts text.inactive {
    display: none !important;
}

/*indicatorçš„æ ·å¼*/
#indicator {
    position: absolute;
    left: 30px;
    bottom: 90px;
    text-align: left;
    color: #f2f2f2;
    font-size: 16px;
}

/*indicatorä¸­æ¯ä¸€ä¸ªå°çš„div/è‰²å—/å›¾ä¾‹çš„æ ·å¼*/
#indicator>div {
    margin-bottom: 10px; 
}

#indicator span {
    display: inline-block;
    width: 35px;
    height: 20px;
    position: relative;
    top: 2px;
    margin-right: 8px;
}

/*mode-æ¨¡å¼åˆ‡æ¢çš„style*/
#mode {
    position: absolute;
    top: 100px;
    left: 30px;
}

#mode span {
    display: inline-block;
    border: 1px solid #fff;
    color: #fff;
    padding: 6px 10px;
    border-radius: 4px;
    font-size: 14px;
    transition: color, background-color .3s; /*CSS3ä¸­çš„æ¸å˜*/
    -o-transition: color, background-color .3s;
    -ms-transition: color, background-color .3s;
    -moz-transition: color, background-color .3s;
    -webkit-transition: color, background-color .3s;
}

/*å½“æŒ‰é”®å¤„äºæ¿€æ´»çŠ¶æ€çš„æ—¶å€™*/
#mode span.active {
    background-color: #fff;
    color: #333;
    cursor: pointer;
}

/*å½“æŒ‰é”®å¤„äºé¼ æ ‡æ‚¬æµ®çŠ¶æ€çš„æ—¶å€™*/
#mode span:hover {
    background-color: #aaa;
    color: #333;
    cursor: pointer;
}

/*switch1-èœå“å¤§ç±»å®ä½“æ˜¾ç¤ºå¼€å…³åˆ‡æ¢çš„style*/
#switch1 {
    position: absolute;
    top: 225px;
    left: 170px;
}

#switch1 span {
    display: inline-block;
    border: 1px solid #fff;
    color: #fff;
    padding: 3px 10px;
    border-radius: 4px;
    font-size: 12px;
    transition: color, background-color .3s; /*CSS3ä¸­çš„æ¸å˜*/
    -o-transition: color, background-color .3s;
    -ms-transition: color, background-color .3s;
    -moz-transition: color, background-color .3s;
    -webkit-transition: color, background-color .3s;
}

/*å½“æŒ‰é”®å¤„äºæ¿€æ´»æˆ–è€…é¼ æ ‡æ‚¬æµ®çŠ¶æ€çš„æ—¶å€™*/
#switch1 span.active, #switch1 span:hover {
    background-color: #fff;
    color: #333;
    cursor: pointer;
}

/*switch2-èœå“å¤§ç±»å®ä½“æ˜¾ç¤ºå¼€å…³åˆ‡æ¢çš„style*/
#switch2 {
    position: absolute;
    top: 260px;
    left: 170px;
}

#switch2 span {
    display: inline-block;
    border: 1px solid #fff;
    color: #fff;
    padding: 3px 10px;
    border-radius: 4px;
    font-size: 12px;
    transition: color, background-color .3s; /*CSS3ä¸­çš„æ¸å˜*/
    -o-transition: color, background-color .3s;
    -ms-transition: color, background-color .3s;
    -moz-transition: color, background-color .3s;
    -webkit-transition: color, background-color .3s;
}

/*å½“æŒ‰é”®å¤„äºæ¿€æ´»æˆ–è€…é¼ æ ‡æ‚¬æµ®çŠ¶æ€çš„æ—¶å€™*/
#switch2 span.active, #switch2 span:hover {
    background-color: #fff;
    color: #333;
    cursor: pointer;
}

/*switch3-èœå“å¤§ç±»å®ä½“æ˜¾ç¤ºå¼€å…³åˆ‡æ¢çš„style*/
#switch3 {
    position: absolute;
    top: 293px;
    left: 170px;
}

#switch3 span {
    display: inline-block;
    border: 1px solid #fff;
    color: #fff;
    padding: 3px 10px;
    border-radius: 4px;
    font-size: 12px;
    transition: color, background-color .3s; /*CSS3ä¸­çš„æ¸å˜*/
    -o-transition: color, background-color .3s;
    -ms-transition: color, background-color .3s;
    -moz-transition: color, background-color .3s;
    -webkit-transition: color, background-color .3s;
}

/*å½“æŒ‰é”®å¤„äºæ¿€æ´»æˆ–è€…é¼ æ ‡æ‚¬æµ®çŠ¶æ€çš„æ—¶å€™*/
#switch3 span.active, #switch3 span:hover {
    background-color: #fff;
    color: #333;
    cursor: pointer;
}

/*infoçš„æ ·å¼*/
#info {
    position: absolute;
    top: 0px;			/*10px*/
    /*bottom: 40px;*/
    right: 10px;   		/*20px*/
    text-align: right;		/*right*/
    width: 253px;  		/*255px*/
}

#info p {
    color: #fff;
    font-size: 12px;
    margin-top: 0px;
    margin-bottom: 5px;
}

#info p span {
    color: #888;
    margin-right: 0px;
}

/*tipsçš„æ ·å¼*/
#tips {
    position: absolute;
    left: 20px;
    right: 10px;
    top: 350px;
    text-align: left;
    color: #f2f2f2;
    font-size: 12px;
    width:230px;
}

/*indicatorä¸­æ¯ä¸€ä¸ªå°çš„div/è‰²å—/å›¾ä¾‹çš„æ ·å¼*/
#tips>div {
    margin-bottom: 5px; 
}

#tips span {
    display: inline-block;
    width: 60px;
    height: 20px;
    position: relative;
    top: 2px;
    margin-right: 8px;
    font-size: 16px;
}

/*æœç´¢æ¡†çš„æ ·å¼*/
#search input {
    position: absolute;
    top: 150px;
    left: 30px;
    color: #fff;
    border: none;
    outline: none;
    box-shadow: none;
    width: 200px;
    background-color: #666;
}

</style>

<body>
    <!-- æ ‡é¢˜ -->
    <h1 style="color: #fff;font-size: 32px;margin-bottom: 10px;margin-top: 10px; text-align: left;margin-left: 40px">å…«å¤§èœç³»çƒ­é—¨èœè°±[text mining]</h1>

    <!-- å®šä¹‰divå­˜æ”¾å…³ç³»å›¾ -->
    <!-- NOTE: çˆ¶å…ƒç´ é‡‡ç”¨ç›¸å¯¹å®šä½ï¼Œé‡Œé¢çš„å…ƒç´ é‡‡ç”¨ç»å¯¹å®šä½ -->
    <div style="text-align: center;position: relative;">
        <svg width="860" height="560" style="margin-left: 30px;margin-bottom: -150px" id="svg1"></svg>
        <!-- å›¾ä¾‹ -->
        <div id="indicator"></div>

        <!-- æ¨¡å¼ -->
        <div id="mode">
            <span class="active" style="border-top-right-radius: 0;border-bottom-right-radius: 0;">Circles</span>
            <span style="border-top-left-radius: 0;border-bottom-left-radius: 0;position: relative;left: -5px;">Texts</span>
        </div>

	<!-- æ˜¾ç¤ºåˆ‡æ¢1 -->
        <div id="switch1">
            <span class="active" style="border-top-right-radius: 0;border-bottom-right-radius: 0;">On</span>
            <span style="border-top-left-radius: 0;border-bottom-left-radius: 0;position: relative;left: -5px;">Off</span>
        </div>

	<!-- æ˜¾ç¤ºåˆ‡æ¢2 -->
        <div id="switch2">
            <span class="active" style="border-top-right-radius: 0;border-bottom-right-radius: 0;">On</span>
            <span style="border-top-left-radius: 0;border-bottom-left-radius: 0;position: relative;left: -5px;">Off</span>
        </div>

	<!-- æ˜¾ç¤ºåˆ‡æ¢3 -->
        <div id="switch3">
            <span class="active" style="border-top-right-radius: 0;border-bottom-right-radius: 0;">On</span>
            <span style="border-top-left-radius: 0;border-bottom-left-radius: 0;position: relative;left: -5px;">Off</span>
        </div>


        <!-- æœç´¢æ¡† -->
        <div id="search">
            <input type="text" autocomplete="off" class="form-control">
        </div>

        <!-- æ¯ä¸ªç»“ç‚¹çš„ä¿¡æ¯ -->
        <div id="info">
            <h4></h4>
        </div>

	<!-- æç¤º -->
        <div id="tips"></div>
    </div>
    /*
    <div style="text-align: center;position: relative;">
        <svg width="960" height="240" id="svg2" style="margin-right: 60px;">
            <!-- D3 -->
            <g></g>
        </svg>
    </div>
    */

</body>
<script src="https://d3js.org/d3.v4.min.js"></script>
<!-- è‡ªå®šä¹‰çš„jsä»£ç  -->
<script>
$(document).ready(function() {
    // å®šä¹‰svgå˜é‡ï¼Œé€‰å‡ºç¬¬ä¸€ä¸ªå›¾
    var svg = d3.select("#svg1"), 
              width = svg.attr('width'), 
              height = svg.attr('height');

    var names = ['èœç³»', 'èœå“', 'åŸæ–™']
    var colors = ['#6ca46c', '#ca635f', '#4e88af'];
//    var outlier_avatar_ID = ['0001', '0002', '0003', '0004', '0005', '0006', '0007', '0008', '0009', '0177', '0377', '0378', '0659'];

    for (var i = 0; i < names.length; i++) {
        // é€‰ä¸­indicatorï¼Œæ¯ä¸€ç§éƒ½appendä¸€ä¸ªdivï¼Œå°±æ˜¯å‰é¢çš„å°è‰²å—
        $('#indicator').append("<div><span style='background-color:" + colors[i] + "'></span>" + names[i] +"</div>")
    }

    var help = ['å°åŠ©æ‰‹', '1.å˜¿å˜¿å˜¿ğŸˆ²ğŸ˜„'];
    $('#tips').append("<div><span>" + help[0] + "</span></div>")
    for (var i = 1; i < help.length; i++) {
        // é€‰ä¸­indicatorï¼Œæ¯ä¸€ç§éƒ½appendä¸€ä¸ªdivï¼Œå°±æ˜¯å‰é¢çš„å°è‰²å—
        $('#tips').append("<div>" + help[i] +"</div>")
    }

    // å®šä¹‰D3çš„simulationæ˜¯å¦‚ä½•å±•ç¤ºå‡ºæ¥çš„
    var simulation = d3.forceSimulation()
        .force("link", d3.forceLink().id(function(d) {
            return d.id;
        }))
        .force("charge", d3.forceManyBody())
        .force("center", d3.forceCenter(width / 2, height / 2));

    // å­˜ä¹‹åç”Ÿæˆçš„å…³ç³»å›¾æ•°æ®
    var graph;

    d3.json("https://raw.githubusercontent.com/dc-wangpc/Recipe-KG/main/vizdata_mimini_aglin.json", function(error, data) {
        if (error) throw error;

        graph = data;
        // console.log(graph)

        // D3æ•°æ®é©±åŠ¨æ–‡æ¡£
        // ç”¨linkså»é©±åŠ¨lineçš„çº¿å®½
        var link = svg.append('g')
            .attr("class", "links")
            .selectAll("line")
            .data(graph.links)
            .enter().append("line")
            .attr('stroke-width', function(d){
            // return Math.sqrt(d.value);
            return 1;
            });

        //è¾¹ä¸Šçš„æ–‡å­—ï¼ˆå®ä½“ä¹‹é—´çš„å…³ç³»ï¼‰ 
        var linktext = svg.append('g')
            .attr("class", "linetexts")
            .selectAll("text")
            .data(graph.links)
            .enter()
            .append("text")
            .style("display","block")
            .style("color","red")
            .text(function(d){
                return d.relation;
            });

        // æ·»åŠ æ‰€æœ‰çš„node
        var node = svg.append('g')
            .attr('class', 'nodes')
            .selectAll('circle')
            .data(graph.nodes)
            .enter().append('circle')
            .attr("r", function(d) {
                return d.size
            })
            .attr('fill', function(d){ // å¡«å……çš„é¢œè‰²
                return colors[d.group];
            })
            .attr('stroke', 'none')    // æ²¡æœ‰æè¾¹
            .attr('name', function(d){
                return d.id;
            })
            .call(d3.drag()             // ç»‘å®šd3çš„æ‹–åŠ¨å‡½æ•°
                .on("start", dragstarted) // æ‹–åŠ¨å¼€å§‹
                .on("drag", dragged)      // æ‹–åŠ¨è¿›è¡Œ
                .on("end", dragended));   // æ‹–åŠ¨ç»“æŸ

        // æ–‡æœ¬
        // ä¸¤ç§æ˜¾ç¤ºæ¨¡å¼ï¼Œæ¯ä¸ªç»“ç‚¹å¯ä»¥ç”¨ä¸€ä¸ªåœ†æˆ–è€…æ–‡æœ¬è¡¨ç¤º
        var text = svg.append('g')
            .attr("class", "texts")
            .selectAll("text")
            .data(graph.nodes)
            .enter().append("text")
            .attr("font-size", function(d) {
                return d.size
            })
            .attr("fill", function(d) {
                return colors[d.group];
            })
            .attr('name', function(d) {
                return d.id;
            })
            .text(function(d) {
                return d.id;
            })
            .attr('text-anchor', 'middle')
            .call(d3.drag()
                .on("start", dragstarted)
                .on("drag", dragged)
                .on("end", dragended));

        // ç»™nodeåŠ title, å½“é¼ æ ‡æ‚¬æµ®åœ¨åœ†åœˆä¸Šçš„æ—¶å€™
        node.append('title').text(function(d){
            return d.id;
        })

        // å¤„ç†ç¼©æ”¾
        svg.call(d3.zoom()
            .scaleExtent([1 / 8, 8])
            .on("zoom", zoomed));
         
        function zoomed() {
            link.attr("transform", d3.event.transform);
            node.attr("transform", d3.event.transform);
            text.attr("transform", d3.event.transform);
            linktext.attr('transform', d3.event.transform);
        }

        simulation
            .nodes(graph.nodes)
            .on("tick", ticked);

        simulation.force("link")
            .links(graph.links);

        function ticked() {
            link
                .attr("x1", function(d) {
                    return d.source.x;
                })
                .attr("y1", function(d) {
                    return d.source.y;
                })
                .attr("x2", function(d) {
                    return d.target.x;
                })
                .attr("y2", function(d) {
                    return d.target.y;
                });

            linktext.attr("dx",function(d){ return (d.source.x + d.target.x) / 2 ; });
            linktext.attr("dy",function(d){ return (d.source.y + d.target.y) / 2 ; });

            node
                .attr("cx", function(d) {
                    return d.x;
                })
                .attr("cy", function(d) {
                    return d.y;
                });

            text
                .attr("dx", function(d) {
                    return d.x;
                })
                .attr("dy", function(d) {
                    return d.y;
                });
        }
    })

    // æ‹–åŠ¨äº‹ä»¶å‡½æ•°
    var dragging = false;

    function dragstarted(d) {
        if (!d3.event.active) simulation.alphaTarget(0.3).restart();
        d.fx = d.x;
        d.fy = d.y;
        dragging = true;
    }

    function dragged(d) {
        d.fx = d3.event.x;
        d.fy = d3.event.y;
    }

    function dragended(d) {
        if (!d3.event.active) simulation.alphaTarget(0);
        d.fx = null;
        d.fy = null;
        dragging = false;
    }

    // å¤„ç†æ¨¡å¼ç‚¹å‡»åçš„äº‹ä»¶(è¿™äº›å…ƒç´ é¡µé¢ä¸Šæœ¬æ¥æœ‰)
    $('#mode span').click(function(event) {
        // æŠŠmodeé‡Œé¢æ‰€æœ‰spançš„activeå…¨éƒ¨å»æ‰
        // æŠŠè¢«ç‚¹å‡»çš„è¿™ä¸ªè®¾ç½®ä¸ºactive
        $('#mode span').removeClass('active')
        $(this).addClass('active')

        if ($(this).text() == 'Circles') {
            // éšè—æ‰€æœ‰æ–‡æœ¬é‡Œé¢çš„svgå…ƒç´ 
            // æŠŠnodeé‡Œé¢çš„æ˜¾ç¤ºå‡ºæ¥
            $('.texts text').hide();
            $('.nodes circle').show();
        }
        else {
            $('.texts text').show();
            $('.nodes circle').hide ();
        }
    });

    // ä¸‰ä¸ªå¼€å…³æ ‡å¿—ï¼ŒTrueè¡¨ç¤ºæ‰“å¼€
    var sw1 = true;
    var sw2 = true;
    var sw3 = true;

    // å¤„ç†å¼€å…³1ç‚¹å‡»åçš„äº‹ä»¶(è¿™äº›å…ƒç´ é¡µé¢ä¸Šæœ¬æ¥æœ‰)
    $('#switch1 span').click(function(event) {
        // æŠŠmodeé‡Œé¢æ‰€æœ‰spançš„activeå…¨éƒ¨å»æ‰
        // æŠŠè¢«ç‚¹å‡»çš„è¿™ä¸ªè®¾ç½®ä¸ºactive
        $('#switch1 span').removeClass('active')
        $(this).addClass('active')

        if ($(this).text() == 'On') {
	    sw1 = true;
	    d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
	    d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if ((d.source.group == 0 || d.target.group == 0) && sw1 == false) {
                    return 'inactive';
                }
		else if ((d.source.group == 1 || d.target.group == 1) && sw2 == false){
		    return 'inactive';
		}
		else if ((d.source.group == 2 || d.target.group == 2) && sw3 == false){
		    return 'inactive';
		}
		else{
		    return '';
		}
            });
	    d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
	    /*
	    d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“éšè—
		if (d.group == 0) {
		    return '';
		}
		if (d.group == 1 && sw2 == false){
		    return 'inactive';
		}
		if (d.group == 2 && sw3 == false){
		    return 'inactive';
		}
            });
	    d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“éšè—
		if (d.group == 0) {
		    return '';
		}
		if (d.group == 1 && sw2 == false){
		    return 'inactive';
		}
		if (d.group == 2 && sw3 == false){
		    return 'inactive';
		}
            });
	    d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if (d.source.group == 0 || d.target.group == 0) {
                    return '';
                }
		if ((d.source.group == 1 || d.target.group == 1) && sw2 == false){
		    return 'inactive';
		}
		if ((d.source.group == 2 || d.target.group == 2) && sw3 == false){
		    return 'inactive';
		}
            });
	    */
        }
        else {
	    sw1 = false;
	    d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
	    d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if ((d.source.group == 0 || d.target.group == 0) && sw1 == false) {
                    return 'inactive';
                }
		else if ((d.source.group == 1 || d.target.group == 1) && sw2 == false){
		    return 'inactive';
		}
		else if ((d.source.group == 2 || d.target.group == 2) && sw3 == false){
		    return 'inactive';
		}
		else{
		    return '';
		}
            });
	    d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
	    /*
	    d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“éšè—
		if (d.group == 0) {
		    return 'inactive';
		}
		if (d.group == 1 && sw2 == false){
		    return 'inactive';
		}
		if (d.group == 2 && sw3 == false){
		    return 'inactive';
		}
            });
	    d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“éšè—
		if (d.group == 0) {
		    return 'inactive';
		}
		if (d.group == 1 && sw2 == false){
		    return 'inactive';
		}
		if (d.group == 2 && sw3 == false){
		    return 'inactive';
		}
            });
	    d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if (d.source.group == 0 || d.target.group == 0) {
                    return 'inactive';
                }
		if ((d.source.group == 1 || d.target.group == 1) && sw2 == false){
		    return 'inactive';
		}
		if ((d.source.group == 2 || d.target.group == 2) && sw3 == false){
		    return 'inactive';
		}
            });
	    */
        }
    });

    // å¤„ç†å¼€å…³2ç‚¹å‡»åçš„äº‹ä»¶(è¿™äº›å…ƒç´ é¡µé¢ä¸Šæœ¬æ¥æœ‰)
    $('#switch2 span').click(function(event) {
        // æŠŠmodeé‡Œé¢æ‰€æœ‰spançš„activeå…¨éƒ¨å»æ‰
        // æŠŠè¢«ç‚¹å‡»çš„è¿™ä¸ªè®¾ç½®ä¸ºactive
        $('#switch2 span').removeClass('active')
        $(this).addClass('active')

        if ($(this).text() == 'On') {
	    sw2 = true;
	    d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
	    d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if ((d.source.group == 0 || d.target.group == 0) && sw1 == false) {
                    return 'inactive';
                }
		else if ((d.source.group == 1 || d.target.group == 1) && sw2 == false){
		    return 'inactive';
		}
		else if ((d.source.group == 2 || d.target.group == 2) && sw3 == false){
		    return 'inactive';
		}
		else{
		    return '';
		}
            });
	    d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
	    /*
	    d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 1) {
		    return '';
		}
		if (d.group == 0 && sw1 == false){
		    return 'inactive';
		}
		if (d.group == 2 && sw3 == false){
		    return 'inactive';
		}
            });
	    d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 1) {
		    return '';
		}
		if (d.group == 0 && sw1 == false){
		    return 'inactive';
		}
		if (d.group == 2 && sw3 == false){
		    return 'inactive';
		}
            });
	    d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if (d.source.group == 1 || d.target.group == 1) {
                    return '';
                }
		if ((d.source.group == 0 || d.target.group == 0) && sw1 == false){
		    return 'inactive';
		}
		if ((d.source.group == 2 || d.target.group == 2) && sw3 == false){
		    return 'inactive';
		}
            });
	    */
        }
        else {
	    sw2 = false;
	    d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
	    d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if ((d.source.group == 0 || d.target.group == 0) && sw1 == false) {
                    return 'inactive';
                }
		else if ((d.source.group == 1 || d.target.group == 1) && sw2 == false){
		    return 'inactive';
		}
		else if ((d.source.group == 2 || d.target.group == 2) && sw3 == false){
		    return 'inactive';
		}
		else{
		    return '';
		}
            });
	    d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
        }
    });

    // å¤„ç†å¼€å…³3ç‚¹å‡»åçš„äº‹ä»¶(è¿™äº›å…ƒç´ é¡µé¢ä¸Šæœ¬æ¥æœ‰)
    $('#switch3 span').click(function(event) {
        // æŠŠmodeé‡Œé¢æ‰€æœ‰spançš„activeå…¨éƒ¨å»æ‰
        // æŠŠè¢«ç‚¹å‡»çš„è¿™ä¸ªè®¾ç½®ä¸ºactive
        $('#switch3 span').removeClass('active')
        $(this).addClass('active')

        if ($(this).text() == 'On') {
	    sw3 = true;
	    d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
	    d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if ((d.source.group == 0 || d.target.group == 0) && sw1 == false) {
                    return 'inactive';
                }
		else if ((d.source.group == 1 || d.target.group == 1) && sw2 == false){
		    return 'inactive';
		}
		else if ((d.source.group == 2 || d.target.group == 2) && sw3 == false){
		    return 'inactive';
		}
		else{
		    return '';
		}
            });
	    d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
        }
        else {
	    sw3 = false;
	    d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
	    d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if ((d.source.group == 0 || d.target.group == 0) && sw1 == false) {
                    return 'inactive';
                }
		else if ((d.source.group == 1 || d.target.group == 1) && sw2 == false){
		    return 'inactive';
		}
		else if ((d.source.group == 2 || d.target.group == 2) && sw3 == false){
		    return 'inactive';
		}
		else{
		    return '';
		}
            });
	    d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
        }
    });

    // å¤„ç†äº‹ä»¶ï¼šé€‰ä¸­ç»“ç‚¹ååªæ˜¾ç¤ºé€‰ä¸­ç‚¹åŠå…¶ç›´æ¥ç›¸é‚»ç‚¹
    // è¿™äº›å…ƒç´ åŸæ¥æ²¡æœ‰ï¼Œåé¢æ·»åŠ ä¸Šå»ï¼Œæ‰€ä»¥å†™æ³•å’Œä¸Šé¢ä¸åŒ
    // ä¸º#svg1ä¸­æ‰€æœ‰çš„ `.nodes circle` å…ƒç´ ï¼Œç»‘å®šäº† `mouseenter`äº‹ä»¶ 
    $('#svg1').on('mouseenter', '.nodes circle', function(event) {
        // æ‹–åŠ¨çš„æ—¶å€™ï¼Œå¦‚æœç¢°åˆ°åˆ«çš„ç»“ç‚¹ï¼Œæ•ˆæœä¼šå‘ç”Ÿå˜åŒ–ï¼Œçœ‹èµ·æ¥å¾ˆä¹±
        // æ‰€ä»¥æ‹–åŠ¨çš„æ—¶å€™ä¸å…è®¸è§¦å‘é¼ æ ‡è¿›å…¥äº‹ä»¶
        if (!dragging) {
            var name = $(this).attr('name');

            // æŠŠinfoæ ‡é¢˜çš„é¢œè‰²æ”¹ä¸ºç»“ç‚¹æ‰€å±ç±»åˆ«çš„é¢œè‰²
            $('#info h4').css('color', $(this).attr('fill')).text(name);
            // å»æ‰æ—§çš„<p></p>
            $('#info p').remove();

            
	    // å¢åŠ å„ä¸ªäººç‰©çš„å¤´åƒ
            if (typeof(info[name]) != "undefined") {
                //avatar_ID = info[name]['ID'][0]
                //if(outlier_avatar_ID.indexOf(avatar_ID) != -1) {
                //    avatar_ID = avatar_ID + '0'
                //}
	    if ('ä¸»æ–™' in info[name]){
		    $('#info').append('<p>' + '<img src="https://raw.githubusercontent.com/dc-wangpc/Recipe-KG/main/' + name + '.jpg" />' + '</p>');
	    }
            }

            for (var key in info[name]) {
                value = info[name][key];

                var flag_none = false;
                for (var item in value) {
                    if (value[item] == null || value[item] == 'N/A' || value[item] == '') {
                        flag_none = true;
                        break;
                    }
                } 
                if (flag_none == true) {              // æ’é™¤ä¸ºç©ºçš„å±æ€§å€¼
                    continue;
                }

                $('#info').append('<p><span>' + key + '</span></p>');
		var item_info = '';
		count = 0
		for (var food_item in info[name][key]){
			if (count == 0){
				item_info = item_info + info[name][key][food_item];
			}
			else{
				item_info = item_info + "&nbsp;||&nbsp;" + info[name][key][food_item];
			}
			count = count + 1;
		}
		$('#info').append('<p>' + item_info + '</p>');
            }

            d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // æ˜¯ç›®å‰æ‚¬æµ®çš„é‚£ä¸ª
                if (d.id == name) {
                    return '';
                }

                // ä¸æ˜¯æ‚¬æµ®çš„é‚£ä¸ªï¼Œéœ€è¦æ˜¾ç¤ºç›¸é‚»çš„circleï¼Œå¯¹å…¶ä»–çš„åœ†åœˆåšå¤„ç†
                // éå†å›¾ä¸­çš„æ‰€æœ‰link
                for (var i = 0; i < graph.links.length; i++) {
                    if (graph.links[i]['source'].id == name && graph.links[i]['target'].id == d.id) {
                        return '';
                    }
                    if (graph.links[i]['target'].id == name && graph.links[i]['source'].id == d.id) {
                        return '';
                    }
                }

                return 'inactive';
            });

            // å¤„ç†è¿æ¥line, ä¸ç›¸è¿çš„lineä¸æ˜¾ç¤º
            d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if (d.source.id == name || d.target.id == name) {
                    return '';
                } else {
                    return 'inactive';
                }
            });

            // åªæ˜¾ç¤ºä¹‹é—´ç›¸è¿çš„å…³ç³»å
            d3.select("#svg1 .linetexts").selectAll('text').attr('class', function(d) {
                if (d.source.id == name || d.target.id == name) {
                    d3.select(this).attr('fill-opacity', 1);
                } else {
                    d3.select(this).attr('fill-opacity', 0);
                }
            })

            // UPDATE: å¯¹äºtextä¹ŸåŒæ—¶éšè—
            d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                if (d.id == name) {
                    return '';
                }

                for (var i = 0; i < graph.links.length; i++) {
                    if (graph.links[i]['source'].id == name && graph.links[i]['target'].id == d.id) {
                        return '';
                    }
                    if (graph.links[i]['target'].id == name && graph.links[i]['source'].id == d.id) {
                        return '';
                    }
                }

                return 'inactive';
            });
        }
    });

    // å¤„ç†é¼ æ ‡ç§»å¼€çš„äº‹ä»¶ä¸Š
    $('#svg1').on('mouseleave', '.nodes circle', function(event) {
        if (!dragging && $('#search input').val() != '') {
	    /*
            //å¦‚æœæœç´¢æ¡†è¿˜æœ‰ä¸œè¥¿ï¼Œç§»å¼€é¼ æ ‡åä»ç„¶æ˜¾ç¤ºæœç´¢çš„ç»“æœ
            var name = $('#search input').val();
            d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d) {
                if (d.id.toLowerCase().indexOf(name.toLowerCase()) >= 0) {
                    return '';
                } else {
                   return 'inactive';
                }
            });
            d3.select('#svg1 .texts').selectAll('text').attr('class', function(d) {
                if (d.id.toLowerCase().indexOf(name.toLowerCase()) >= 0) {
                    return '';
                } else {
                    return 'inactive';
                }
            });
            d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                return 'inactive';
            });
	    //d3.select('#svg1 .links').selectAll('line').attr('class', '');;
	    d3.select("#svg1 .linetexts").selectAll('text').attr('fill-opacity', function(d) {
                return 0;
            });
	    */
        }
        else if (!dragging && $('#search input').val() == '') {
            // å¦åˆ™ï¼Œç¦»å¼€æ—¶æŠŠnodeså’Œlinksçš„inactiveå»æ‰
            //d3.select('#svg1 .texts').selectAll('text').attr('class', '');;
            //d3.select('#svg1 .nodes').selectAll('circle').attr('class', '');;
            //d3.select('#svg1 .links').selectAll('line').attr('class', '');;
            d3.select("#svg1 .linetexts").selectAll('text').attr('fill-opacity', 0);
	    d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
	    d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if ((d.source.group == 0 || d.target.group == 0) && sw1 == false) {
                    return 'inactive';
                }
		else if ((d.source.group == 1 || d.target.group == 1) && sw2 == false){
		    return 'inactive';
		}
		else if ((d.source.group == 2 || d.target.group == 2) && sw3 == false){
		    return 'inactive';
		}
		else{
		    return '';
		}
            });
	    d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
        }
    });

    $('#svg1').on('mouseenter', '.texts text', function(event) {
        if (!dragging) {
            var name = $(this).attr('name');

            // æŠŠinfoæ ‡é¢˜çš„é¢œè‰²æ”¹ä¸ºç»“ç‚¹æ‰€å±ç±»åˆ«çš„é¢œè‰²
            $('#info h4').css('color', $(this).attr('fill')).text(name);
            // å»æ‰æ—§çš„<p></p>
            $('#info p').remove();

            
	    // å¢åŠ å„ä¸ªäººç‰©çš„å¤´åƒ
            if (typeof(info[name]) != "undefined") {
                //avatar_ID = info[name]['ID'][0]
                //if(outlier_avatar_ID.indexOf(avatar_ID) != -1) {
                //    avatar_ID = avatar_ID + '0'
                //}

	    if ('ä¸»æ–™' in info[name]){
                $('#info').append('<p>' + '<img src="https://raw.githubusercontent.com/ngl567/CookBook-KG/master/visualization/recipe_photo/' + name + '.jpg" />' + '</p>');
	    }

            }
	    

            for (var key in info[name]) {
                value = info[name][key];

                var flag_none = false;
                for (var item in value) {
                    if (value[item] == null || value[item] == 'N/A' || value[item] == '') {
                        flag_none = true;
                        break;
                    }
                } 
                if (flag_none == true) {              // æ’é™¤ä¸ºç©ºçš„å±æ€§å€¼
                    continue;
                }

		$('#info').append('<p><span>' + key + '</span></p>');
		var item_info = '';
		count = 0
		for (var food_item in info[name][key]){
			if (count == 0){
				item_info = item_info + info[name][key][food_item];
			}
			else{
				item_info = item_info + "&nbsp;||&nbsp;" + info[name][key][food_item];
			}
			count = count + 1;
		}
		$('#info').append('<p>' + item_info + '</p>');
                //$('#info').append('<p><span>' + key + '</span>' + info[name][key] + '</p>');
            }

            d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                if (d.id == name) {
                    return '';
                }

                for (var i = 0; i < graph.links.length; i++) {
                    if (graph.links[i]['source'].id == name && graph.links[i]['target'].id == d.id) {
                        return '';
                    }
                    if (graph.links[i]['target'].id == name && graph.links[i]['source'].id == d.id) {
                        return '';
                    }
                }

                return 'inactive';
            });

            d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if (d.source.id == name || d.target.id == name) {
                    return '';
                } else {
                    return 'inactive';
                }
            });

            // åªæ˜¾ç¤ºä¹‹é—´ç›¸è¿çš„å…³ç³»å
            d3.select("#svg1 .linetexts").selectAll('text').attr('class', function(d) {
                if (d.source.id == name || d.target.id == name) {
                    d3.select(this).attr('fill-opacity', 1);
                } else {
                    d3.select(this).attr('fill-opacity', 0);
                }
            })

            // UPDATE: å¯¹äºcircleä¹ŸåŒæ—¶éšè—
            d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // æ˜¯ç›®å‰æ‚¬æµ®çš„é‚£ä¸ª
                if (d.id == name) {
                    return '';
                }

                // ä¸æ˜¯æ‚¬æµ®çš„é‚£ä¸ªï¼Œéœ€è¦æ˜¾ç¤ºç›¸é‚»çš„circleï¼Œå¯¹å…¶ä»–çš„åœ†åœˆåšå¤„ç†
                // éå†å›¾ä¸­çš„æ‰€æœ‰link
                for (var i = 0; i < graph.links.length; i++) {
                    if (graph.links[i]['source'].id == name && graph.links[i]['target'].id == d.id) {
                        return '';
                    }
                    if (graph.links[i]['target'].id == name && graph.links[i]['source'].id == d.id) {
                        return '';
                    }
                }

                return 'inactive';
            });
        }
    });

    $('#svg1').on('mouseleave', '.texts text', function(event) {
        if (!dragging && $('#search input').val() != '') {
	    /*
            // å¦‚æœæœç´¢æ¡†è¿˜æœ‰ä¸œè¥¿ï¼Œç§»å¼€é¼ æ ‡åä»ç„¶æ˜¾ç¤ºæœç´¢çš„ç»“æœ
            var name = $('#search input').val();
            d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d) {
                if (d.id.toLowerCase().indexOf(name.toLowerCase()) >= 0) {
                   return '';
                } else {
                   return 'inactive';
                }
            });
            d3.select('#svg1 .texts').selectAll('text').attr('class', function(d) {
                if (d.id.toLowerCase().indexOf(name.toLowerCase()) >= 0) {
                    return '';
                } else {
                    return 'inactive';
                }
            });
            d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                return 'inactive';
            });
	    //d3.select('#svg1 .links').selectAll('line').attr('class', '');;
	    d3.select("#svg1 .linetexts").selectAll('text').attr('fill-opacity', function(d) {
                return 0;
            });
	    */
        }
        else if (!dragging && $('#search input').val() == '') {
            // å¦åˆ™ï¼Œç¦»å¼€æ—¶æŠŠnodeså’Œlinksçš„inactiveå»æ‰
            //d3.select('#svg1 .texts').selectAll('text').attr('class', '');;
            //d3.select('#svg1 .nodes').selectAll('circle').attr('class', '');;
            //d3.select('#svg1 .links').selectAll('line').attr('class', '');;
            d3.select("#svg1 .linetexts").selectAll('text').attr('fill-opacity', 0);
	    d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
	    d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                if ((d.source.group == 0 || d.target.group == 0) && sw1 == false) {
                    return 'inactive';
                }
		else if ((d.source.group == 1 || d.target.group == 1) && sw2 == false){
		    return 'inactive';
		}
		else if ((d.source.group == 2 || d.target.group == 2) && sw3 == false){
		    return 'inactive';
		}
		else{
		    return '';
		}
            });
	    d3.select('#svg1 .texts').selectAll('text').attr('class', function(d){
                // å½“å‰é€‰ä¸­ç±»å‹å®ä½“æ˜¾ç¤º
		if (d.group == 0 && sw1 == true) {
		    return '';
		}
		else if (d.group == 1 && sw2 == true){
		    return '';
		}
		else if (d.group == 2 && sw3 == true){
		    return '';
		}
		else{
		    return 'inactive'
		}
            });
        }
    });

    // æœç´¢æ¡†
    $('#search input').keyup(function(event) {
        // å¦‚æœè¾“å…¥ä¸ºç©ºï¼Œå…¨éƒ¨æ˜¾ç¤ºå‡ºæ¥
        if ($(this).val() == '') {
            d3.select('#svg1 .texts').selectAll('text').attr('class', '');;
            d3.select('#svg1 .nodes').selectAll('circle').attr('class', '');;
            d3.select('#svg1 .links').selectAll('line').attr('class', '');;
            d3.select("#svg1 .linetexts").selectAll('text').attr('fill-opacity', 0);
        }
        else { // ç­›é€‰ï¼Œåˆ¤æ–­è¿™ä¸‰ä¸ªä¸œè¥¿é‡Œçš„å…ƒç´ æ˜¯å¦åŒ…å«è¾“å…¥çš„ä¸œè¥¿
            var name = $(this).val();
            d3.select('#svg1 .nodes').selectAll('circle').attr('class', function(d) {
                if (d.id.toLowerCase().indexOf(name.toLowerCase()) >= 0) {
                    return '';
                } else {
                    return 'inactive';
                }
            });
            d3.select('#svg1 .texts').selectAll('text').attr('class', function(d) {
                if (d.id.toLowerCase().indexOf(name.toLowerCase()) >= 0) {
                    return '';
                } else {
                    return 'inactive';
                }
            });
            d3.select("#svg1 .links").selectAll('line').attr('class', function(d) {
                return 'inactive';
            });
            d3.select("#svg1 .linetexts").selectAll('text').attr('fill-opacity', 0);
        }
    });

    // å¦‚æœç”¨åˆ é™¤é”®åˆ é™¤äº†
    // ç‚¹å‡»åˆ°æœç´¢æ¡†å†…
    $('#search input').bind('click', function(e) { 
       if ($('#search input').val() == '') {
           d3.select('#svg1 .texts').selectAll('text').attr('class', '');;
           d3.select('#svg1 .nodes').selectAll('circle').attr('class', '');;
           d3.select('#svg1 .links').selectAll('line').attr('class', '');;
           d3.select("#svg1 .linetexts").selectAll('text').attr('fill-opacity', 0);
       }
    })
    // ç‚¹å‡»åˆ°æœç´¢æ¡†å¤–
    $('#search input').bind('blur', function(e) { 
       if ($('#search input').val() == '') {
           d3.select('#svg1 .texts').selectAll('text').attr('class', '');;
           d3.select('#svg1 .nodes').selectAll('circle').attr('class', '');;
           d3.select('#svg1 .links').selectAll('line').attr('class', '');;
           d3.select("#svg1 .linetexts").selectAll('text').attr('fill-opacity', 0);
       }
    })

    // ç»“ç‚¹ä¿¡æ¯æ¡†
    var info;

    d3.json("https://raw.githubusercontent.com/dc-wangpc/Recipe-KG/main/entities_item_mimini.json", function(error, data){
        info = data;
    })

});
</script>
</html>
